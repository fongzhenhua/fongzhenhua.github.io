<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#9400D3"><meta name="generator" content="Hexo 5.4.2">
<link rel="preconnect" href="https://s4.zstatic.net" crossorigin>
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#9400D3">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.css" integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.21.1","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"default"},"fold":{"enable":true,"height":500},"bookmark":{"enable":true,"color":"#9400D3","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":false,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.json","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":true}}</script><script src="/js/config.js"></script>



<link rel="canonical" href="http://example.com/page/21/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/21/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>BNU-FZH</title>
  







<script async src="/lib/fireworks.js"></script>
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">BNU-FZH</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">fengzhenhua@outlook.com</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-导航"><a href="/%E5%AF%BC%E8%88%AA/" rel="section"><i class="fa fa-paper-plane fa-fw"></i>导航</a></li><li class="menu-item menu-item-软件"><a href="/%E8%BD%AF%E4%BB%B6/" rel="section"><i class="fa fa-briefcase fa-fw"></i>软件</a></li><li class="menu-item menu-item-收藏"><a href="/%E6%94%B6%E8%97%8F/" rel="section"><i class="fa fa-folder fa-fw"></i>收藏</a></li><li class="menu-item menu-item-工作"><a href="/%E5%B7%A5%E4%BD%9C/" rel="section"><i class="fa fa-folder fa-fw"></i>工作</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name"></p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">547</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://chat.deepseek.com/" title="深度求索 → https:&#x2F;&#x2F;chat.deepseek.com&#x2F;" rel="noopener me" target="_blank"><i class="fa-solid fa-brain fa-fw"></i>深度求索</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.tongyi.com/" title="通义千问 → https:&#x2F;&#x2F;www.tongyi.com&#x2F;" rel="noopener me" target="_blank"><i class="fa-solid fa-brain fa-fw"></i>通义千问</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.scnet.cn/ui/chatbot/" title="国家超算 → https:&#x2F;&#x2F;www.scnet.cn&#x2F;ui&#x2F;chatbot&#x2F;" rel="noopener me" target="_blank"><i class="fa-solid fa-brain fa-fw"></i>国家超算</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://yuanbao.tencent.com/chat" title="腾讯元宝 → https:&#x2F;&#x2F;yuanbao.tencent.com&#x2F;chat" rel="noopener me" target="_blank"><i class="fa-solid fa-brain fa-fw"></i>腾讯元宝</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://cn.bing.com/" title="必应搜索 → https:&#x2F;&#x2F;cn.bing.com" rel="noopener me" target="_blank"><i class="fa fa-search fa-fw"></i>必应搜索</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.hao268.com/" title="网址之家 → https:&#x2F;&#x2F;www.hao268.com" rel="noopener me" target="_blank"><i class="fa fa-search fa-fw"></i>网址之家</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://ac.scmor.com/" title="思谋学术 → https:&#x2F;&#x2F;ac.scmor.com" rel="noopener me" target="_blank"><i class="fa fa-graduation-cap fa-fw"></i>思谋学术</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://search.essclick.com/" title="爱思学术 → https:&#x2F;&#x2F;search.essclick.com" rel="noopener me" target="_blank"><i class="fa fa-graduation-cap fa-fw"></i>爱思学术</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://scholar.lanfanshu.cn/" title="番薯学术 → https:&#x2F;&#x2F;scholar.lanfanshu.cn&#x2F;" rel="noopener me" target="_blank"><i class="fas fa-book fa-fw"></i>番薯学术</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://xmsoushu.com/" title="熊猫搜书 → https:&#x2F;&#x2F;xmsoushu.com&#x2F;" rel="noopener me" target="_blank"><i class="fas fa-book fa-fw"></i>熊猫搜书</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://cn.bing.com/translator" title="必应翻译 → https:&#x2F;&#x2F;cn.bing.com&#x2F;translator" rel="noopener me" target="_blank"><i class="fa fa-language fa-fw"></i>必应翻译</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://fanyi.baidu.com/#zh/en" title="百度翻译 → https:&#x2F;&#x2F;fanyi.baidu.com&#x2F;#zh&#x2F;en" rel="noopener me" target="_blank"><i class="fa fa-language fa-fw"></i>百度翻译</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://fanyi.youdao.com/?keyfrom=fanyi.logo" title="有道翻译 → https:&#x2F;&#x2F;fanyi.youdao.com&#x2F;?keyfrom&#x3D;fanyi.logo" rel="noopener me" target="_blank"><i class="fa fa-language fa-fw"></i>有道翻译</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.oxfordlearnersdictionaries.com/definition/english/" title="牛津翻译 → https:&#x2F;&#x2F;www.oxfordlearnersdictionaries.com&#x2F;definition&#x2F;english&#x2F;" rel="noopener me" target="_blank"><i class="fa fa-language fa-fw"></i>牛津翻译</a>
      </span>
      <span class="links-of-author-item">
        <a href="http://tools.liumingye.cn/music/#/" title="音乐下载 → http:&#x2F;&#x2F;tools.liumingye.cn&#x2F;music&#x2F;#&#x2F;" rel="noopener me" target="_blank"><i class="fa fa-music fa-fw"></i>音乐下载</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://wx.qq.com/" title="网页微信 → https:&#x2F;&#x2F;wx.qq.com" rel="noopener me" target="_blank"><i class="fab fa-weixin fa-fw"></i>网页微信</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://login.partner.microsoftonline.cn/" title="微软办公 → https:&#x2F;&#x2F;login.partner.microsoftonline.cn" rel="noopener me" target="_blank"><i class="fas fa-file fa-fw"></i>微软办公</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://mathsolver.microsoft.com/" title="微软数学 → https:&#x2F;&#x2F;mathsolver.microsoft.com" rel="noopener me" target="_blank"><i class="fas fa-file fa-fw"></i>微软数学</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.mail.bnu.edu.cn/" title="师大邮箱 → https:&#x2F;&#x2F;www.mail.bnu.edu.cn" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>师大邮箱</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://mail.sina.com.cn/" title="新浪邮箱 → https:&#x2F;&#x2F;mail.sina.com.cn" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>新浪邮箱</a>
      </span>
      <span class="links-of-author-item">
        <a href="http://192.168.1.14/" title="实验信息 → http:&#x2F;&#x2F;192.168.1.14&#x2F;" rel="noopener me" target="_blank"><i class="fa-solid fa-cloud fa-fw"></i>实验信息</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.aliyundrive.com/sign/in" title="阿里云盘 → https:&#x2F;&#x2F;www.aliyundrive.com&#x2F;sign&#x2F;in" rel="noopener me" target="_blank"><i class="fa fa-hdd fa-fw"></i>阿里云盘</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://yun.139.com/w/#/" title="移动云盘 → https:&#x2F;&#x2F;yun.139.com&#x2F;w&#x2F;#&#x2F;" rel="noopener me" target="_blank"><i class="fa fa-hdd fa-fw"></i>移动云盘</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.jianguoyun.com/d/login" title="坚果网盘 → https:&#x2F;&#x2F;www.jianguoyun.com&#x2F;d&#x2F;login" rel="noopener me" target="_blank"><i class="fa fa-hdd fa-fw"></i>坚果网盘</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://efss.qloud.my/index.php/login?clear=1" title="Next云盘 → https:&#x2F;&#x2F;efss.qloud.my&#x2F;index.php&#x2F;login?clear&#x3D;1" rel="noopener me" target="_blank"><i class="fa fa-hdd fa-fw"></i>Next云盘</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.123pan.com/" title="123 网盘 → https:&#x2F;&#x2F;www.123pan.com&#x2F;" rel="noopener me" target="_blank"><i class="fa fa-hdd fa-fw"></i>123 网盘</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://annas-archive.org/" title="安娜档案 → https:&#x2F;&#x2F;annas-archive.org&#x2F;" rel="noopener me" target="_blank"><i class="fas fa-book fa-fw"></i>安娜档案</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://book.sciencereading.cn/" title="科学文库 → https:&#x2F;&#x2F;book.sciencereading.cn" rel="noopener me" target="_blank"><i class="fas fa-book fa-fw"></i>科学文库</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://ylibrary.org/" title="Ylibrary → https:&#x2F;&#x2F;ylibrary.org&#x2F;" rel="noopener me" target="_blank"><i class="fas fa-book fa-fw"></i>Ylibrary</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.tboxn.com/sites/320.html" title="Zlibrary → https:&#x2F;&#x2F;www.tboxn.com&#x2F;sites&#x2F;320.html" rel="noopener me" target="_blank"><i class="fas fa-book fa-fw"></i>Zlibrary</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.koushare.com/" title="蔻享官网 → https:&#x2F;&#x2F;www.koushare.com" rel="noopener me" target="_blank"><i class="fas fa-globe-asia fa-fw"></i>蔻享官网</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.duolingo.cn/" title="多邻国官 → https:&#x2F;&#x2F;www.duolingo.cn" rel="noopener me" target="_blank"><i class="fas fa-school fa-fw"></i>多邻国官</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.bnu.edu.cn/" title="师大官网 → https:&#x2F;&#x2F;www.bnu.edu.cn" rel="noopener me" target="_blank"><i class="fas fa-university fa-fw"></i>师大官网</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://one.bnu.edu.cn/" title="数字京师 → https:&#x2F;&#x2F;one.bnu.edu.cn" rel="noopener me" target="_blank"><i class="fas fa-university fa-fw"></i>数字京师</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.runoob.com/font-awesome/fontawesome-icons-brand.html" title="图站图标 → https:&#x2F;&#x2F;www.runoob.com&#x2F;font-awesome&#x2F;fontawesome-icons-brand.html" rel="noopener me" target="_blank"><i class="fas fa-globe fa-fw"></i>图站图标</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://shields.io/badges" title="项目微标 → https:&#x2F;&#x2F;shields.io&#x2F;badges" rel="noopener me" target="_blank"><i class="fas fa-globe fa-fw"></i>项目微标</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.latexlive.com/" title="LaTeXLiv → https:&#x2F;&#x2F;www.latexlive.com" rel="noopener me" target="_blank"><i class="fas fa-globe fa-fw"></i>LaTeXLiv</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.latexlive.com/help" title="LaTeXHel → https:&#x2F;&#x2F;www.latexlive.com&#x2F;help" rel="noopener me" target="_blank"><i class="fas fa-globe fa-fw"></i>LaTeXHel</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://p2t.breezedeus.com/" title="Pix2Text → https:&#x2F;&#x2F;p2t.breezedeus.com" rel="noopener me" target="_blank"><i class="fas fa-globe fa-fw"></i>Pix2Text</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://simpletex.cn/" title="Simplete → https:&#x2F;&#x2F;simpletex.cn" rel="noopener me" target="_blank"><i class="fas fa-globe fa-fw"></i>Simplete</a>
      </span>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/07/25/Python%E4%B8%AD%E7%9A%84%E6%B5%B7%E8%B1%A1%E8%BF%90%E7%AE%97%E7%AC%A6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BNU-FZH">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | BNU-FZH">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/25/Python%E4%B8%AD%E7%9A%84%E6%B5%B7%E8%B1%A1%E8%BF%90%E7%AE%97%E7%AC%A6/" class="post-title-link" itemprop="url">Python中的海象运算符</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-07-25 19:16:21" itemprop="dateCreated datePublished" datetime="2024-07-25T19:16:21+08:00">2024-07-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-26 18:21:20" itemprop="dateModified" datetime="2025-03-26T18:21:20+08:00">2025-03-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>在 Python 3.8
及更高版本中，引入了一种新的语法特性，称为"海象运算符"（ Walrus Operator
），它使用 <code>:=</code>
符号。这个运算符的主要目的是在表达式中同时进行赋值和返回赋值的值。使用海象运算符可以在一些情况下简化代码，尤其是在需要在表达式中使用赋值结果的情况下。这对于简化循环条件或表达式中的重复计算很有用。</p>
<figure class="highlight python"><figcaption><span>演示海象运算符的使用</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 传统写法</span></span><br><span class="line">n = <span class="number">10</span></span><br><span class="line"><span class="keyword">if</span> n &gt; <span class="number">5</span>:</span><br><span class="line">    <span class="built_in">print</span>(n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用海象运算符</span></span><br><span class="line"><span class="keyword">if</span> (n := <span class="number">10</span>) &gt; <span class="number">5</span>:</span><br><span class="line">    <span class="built_in">print</span>(n)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>if (n := 10) &gt; 5:</code>：这是使用海象运算符（<code>:=</code>）的写法。海象运算符在表达式中进行赋值操作。
<ul>
<li><code>(n := 10)</code>：将变量 n 赋值为
10，同时返回这个赋值结果。</li>
<li><code>&gt; 5</code>：检查赋值后的 n 是否大于
5。如果条件为真，则执行接下来的代码块。</li>
</ul></li>
<li><code>print(n)</code>：如果条件为真，打印变量 n 的值（即 10）。</li>
</ul>
<p>海象运算符的优点：</p>
<ul>
<li>海象运算符（<code>:=</code>）允许在表达式内部进行赋值，这可以减少代码的重复，提高代码的可读性和简洁性。</li>
<li>在上述例子中，传统写法需要单独一行来赋值 n， 然后在 if
语句中进行条件检查。而使用海象运算符的写法可以在 if
语句中直接进行赋值和条件检查。</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/07/25/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80%E7%9A%84%E6%B3%A8%E9%87%8A%E7%AC%A6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BNU-FZH">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | BNU-FZH">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/25/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80%E7%9A%84%E6%B3%A8%E9%87%8A%E7%AC%A6/" class="post-title-link" itemprop="url">各种语言的注释符</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-07-25 18:38:32" itemprop="dateCreated datePublished" datetime="2024-07-25T18:38:32+08:00">2024-07-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-26 18:21:20" itemprop="dateModified" datetime="2025-03-26T18:21:20+08:00">2025-03-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>编程注释是程序中用来解释代码功能和作用的文字内容，它们对于代码的可读性和可维护性非常重要。不同的编程语言对注释符号有不同的要求和规范，下面将介绍一些常见的编程语言中常用的注释符号。</p>
<p>C/C++、Java、C#等类C语言风格的注释：</p>
<ul>
<li>单行注释：使用双斜线（//）开头，注释文字直至该行结束。</li>
<li>多行注释：使用斜线加星号（/）开头，星号加斜线（/）结尾，中间的内容都会被注释掉。</li>
</ul>
<p>Python风格的注释：</p>
<ul>
<li>单行注释：使用井号（#）开头，注释文字直至该行结束。</li>
</ul>
<p>JavaScript风格的注释：</p>
<ul>
<li>单行注释：使用双斜线（//）开头，注释文字直至该行结束。</li>
<li>多行注释：使用斜线加星号（/）开头，星号加斜线（/）结尾，中间的内容都会被注释掉。</li>
</ul>
<p>Shell脚本风格的注释：</p>
<ul>
<li>单行注释：使用井号（#）开头，注释文字直至该行结束。</li>
</ul>
<p>HTML、CSS风格的注释：</p>
<ul>
<li>单行注释：使用斜线加星号（/）开头，星号加斜线（/）结尾，中间的内容都会被注释掉。</li>
</ul>
<p>SQL风格的注释：</p>
<ul>
<li>单行注释：使用双连字符（–）开头，注释文字直至该行结束。</li>
<li>多行注释：使用斜线加星号（/）开头，星号加斜线（/）结尾，中间的内容都会被注释掉。</li>
</ul>
<p>需要注意的是，不同编程语言中注释的使用方式可能会有所不同，因此在具体的编程项目中，需要遵循对应编程语言的注释规范来使用注释符号。同时，良好的注释应该准确、清晰地解释代码的意图和功能，避免在注释中出现笔误或误导性的信息，以提高代码的可读性和可维护性。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/07/25/%E6%96%9C%E6%9D%A0%E4%B8%8E%E5%8F%8D%E6%96%9C%E6%9D%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BNU-FZH">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | BNU-FZH">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/25/%E6%96%9C%E6%9D%A0%E4%B8%8E%E5%8F%8D%E6%96%9C%E6%9D%A0/" class="post-title-link" itemprop="url">斜杠与反斜杠</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-07-25 14:31:46" itemprop="dateCreated datePublished" datetime="2024-07-25T14:31:46+08:00">2024-07-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-26 18:21:20" itemprop="dateModified" datetime="2025-03-26T18:21:20+08:00">2025-03-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>在许多编程语言和日常工作中都会遇到斜杠和反斜杠。它们的具体解释为：</p>
<ul>
<li><p>斜杠(slash): “ /
”是斜杠，因为它的顶端是向前面倾斜的，英文中有时候也叫做“forward
slash”；</p></li>
<li><p>反斜杠(backslash)：“\”是反斜杠，注意，它的顶端是向后倾斜的。要将它和普通的斜杠（“/”）区分开来。</p></li>
</ul>
<p><code>斜杠</code>经常会用来在诸如<code>Unix的文件系统</code>中和<code>万维网网址</code>中表示目录和子目录路径等。很遗憾的是，很多人都把反斜杠（“\”）当做是普通斜杠（“/”）的某种技术用语，错误的使用术语，混淆斜杠和反斜杠的风险让那些足够了解他们的人可以区分他们，但是了解仍不够他们意识到万维网的地址中很少会包含反斜杠（“\”）的。</p>
<h2 id="windows-和-linux-的路径区别">Windows 和 Linux 的路径区别</h2>
<ul>
<li>路径分隔符不同：Windows使用<code>反斜杠</code>“\”，而Linux使用<code>正斜杠</code>“/”。</li>
<li>文件名大小写敏感：Windows不区分大小写，Linux区分大小写。</li>
<li>文件系统根目录不同：Windows的根目录是盘符（如C:\），Linux的根目录是“/”。</li>
<li>文件权限不同：Linux采用基于权限的访问控制，Windows采用基于用户的访问控制。</li>
<li>文件扩展名不同：Windows的文件扩展名以“.”作为分隔符，Linux通常没有特定的分隔符</li>
</ul>
<h2 id="linux-shell-参数续行">Linux Shell 参数续行</h2>
<p><code>Shell</code>命令行下反斜线"\"有两种含义:</p>
<h3 id="对有特殊含义的字符进行转义">对有特殊含义的字符进行转义</h3>
<p>例如 echo "123\ \$"，结果是"123$"</p>
<h3 id="enter-反斜杠后面紧跟回车表示下一行是当前行的续航">\Enter,
反斜杠后面紧跟回车，表示下一行是当前行的续航</h3>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">./configure --sbin-path=/usr/local/nginx/nginx \</span><br><span class="line">     --conf-path=/usr/local/nginx/nginx.conf \</span><br><span class="line">     --pid-path=/usr/local/nginx/nginx.pid \</span><br><span class="line">     --with-http\_ssl\_module \</span><br><span class="line">     --with-pcre=/usr/local/src/pcre-8.21 \</span><br><span class="line">     --with-zlib=/usr/local/src/zlib-1.2.8 \</span><br><span class="line">     --with-openssl=/usr/local/src/openssl-1.0.1c</span><br></pre></td></tr></table></figure>
<h2 id="python-多行语句">Python 多行语句</h2>
<p>Python 通常是一行写完一条语句，但如果语句很长，我们可以使用反斜杠
<code>\\</code> 来实现多行语句，例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">total = item_one + \</span><br><span class="line">        item_two + \</span><br><span class="line">        item_three</span><br></pre></td></tr></table></figure>
<p>在 <code>[]</code>, <code>&#123;&#125;</code>, 或 <code>()</code>
中的多行语句，不需要使用反斜杠 <code>\\</code>，例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">total = [<span class="string">&#x27;item_one&#x27;</span>, <span class="string">&#x27;item_two&#x27;</span>, <span class="string">&#x27;item_three&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;item_four&#x27;</span>, <span class="string">&#x27;item_five&#x27;</span>]</span><br></pre></td></tr></table></figure>
<h2 id="latex-中的反斜杠">LaTeX 中的反斜杠</h2>
<p>LaTeX
中的命令通常是由一个反斜杠加上命令名称，再加上花括号内的参数构成的。</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;ctexart&#125;</span><br></pre></td></tr></table></figure>
<p>LaTeX 中有许多字符都有特殊的意义， LaTeX 中的保留字符有
<code>\#</code>,<code>\$</code>,<code>\%</code>,<code>\&amp;</code>,<code>\_</code>,<code>&#123; &#125;</code>,
<code>\</code>，这些在正文中都不能直接呈现,需借助<code>反斜杠</code>转义。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/07/24/%E5%9C%A8ArchLinux%E4%B8%8A%E9%83%A8%E7%BD%B2SFTP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BNU-FZH">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | BNU-FZH">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/24/%E5%9C%A8ArchLinux%E4%B8%8A%E9%83%A8%E7%BD%B2SFTP/" class="post-title-link" itemprop="url">在ArchLinux上部署SFTP</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-07-24 15:49:10" itemprop="dateCreated datePublished" datetime="2024-07-24T15:49:10+08:00">2024-07-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-26 18:21:20" itemprop="dateModified" datetime="2025-03-26T18:21:20+08:00">2025-03-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <div class="note primary"><p>为了实现远程文件访问，决定在ArchLinux上部署SFTP,
虽然技术上仍然没有测试成功，但是先记录下参考的主要文档<a
target="_blank" rel="noopener" href="https://citizix.com/how-to-set-up-an-sftp-server-on-arch-linux/">How
to set up an SFTP server on Arch Linux</a>，以期日后解决。</p>
</div>
<p>In this guide we are going to set up an sftp server on an Arch Linux
system. We will also set up a form of chroot where users can only access
sftp with the shared credentials.</p>
<p>The File Transfer Protocol is a standard communication protocol used
for the transfer of computer files from a server to a client on a
computer network.</p>
<p>FTP isn’t popular today because it Lacks Security. When a file is
sent using this protocol, the data, username, and password are all
shared in plain text, which means a hacker can access this information
with little to no effort. For data to be secure, you need to use an
upgraded version of FTP like SFTP.</p>
<p>SFTP Secure File Transfer Protocol is a file transfer protocol that
provide secure access to a remote computer to deliver secure
communications. It leverages SSH – Secure Socket Shell and is frequently
also referred to as ‘Secure Shell File Transfer Protocol’.</p>
<h4 id="related-content"><a
target="_blank" rel="noopener" href="https://citizix.com/how-to-set-up-an-sftp-server-on-arch-linux/#related-content">Related
Content</a></h4>
<ul>
<li><a
target="_blank" rel="noopener" href="https://citizix.com/how-to-work-with-sftp-client-in-linux-10-sftp-commands/">How
to work with SFTP client in Linux – 10 sftp commands</a></li>
<li><a
target="_blank" rel="noopener" href="https://citizix.com/how-to-set-up-an-sftp-server-on-debian-11-server/">How
to set up an SFTP server on Debian 11 Server</a></li>
<li><a
target="_blank" rel="noopener" href="https://citizix.com/download-files-from-sftp-server-using-a-python-script/">Download
Files from SFTP server Using a python script</a></li>
<li><a
target="_blank" rel="noopener" href="https://citizix.com/list-upload-and-download-files-from-an-sftp-server-using-golang/">List,
Upload and Download files from an SFTP Server using golang</a></li>
<li><a
target="_blank" rel="noopener" href="https://citizix.com/how-to-set-up-an-sftp-server-on-opensuse-leap-15-3-server/">How
to set up an SFTP server on OpenSUSE Leap 15.3 Server</a></li>
<li><a
target="_blank" rel="noopener" href="https://www.citizix.com/how-to-install-and-set-up-sftp-server-in-ubuntu-20-04/">How
to install and set up sftp server in Ubuntu 20.04</a></li>
<li><a
target="_blank" rel="noopener" href="https://citizix.com/how-to-set-up-an-sftp-server-on-centos-8-rhel-8-server/">How
to set up an SFTP server on CentOS 8 /RHEL 8 Server</a></li>
</ul>
<h2 id="prerequisites"><a
target="_blank" rel="noopener" href="https://citizix.com/how-to-set-up-an-sftp-server-on-arch-linux/#prerequisites">Prerequisites</a></h2>
<p>To follow along this guide ensure you have the following:</p>
<ol type="1">
<li>Arch Linux machine</li>
<li>Root access to the server or a user with root access</li>
<li>Internet access from the server</li>
</ol>
<h2 id="table-of-content"><a
target="_blank" rel="noopener" href="https://citizix.com/how-to-set-up-an-sftp-server-on-arch-linux/#table-of-content">Table
of Content</a></h2>
<ol type="1">
<li>Ensuring that the server is up to date</li>
<li>Ensuring that the SSH service is installed</li>
<li>Creating users and groups and adding the necessary directories</li>
<li>Configuring the ssh service</li>
<li>Verifying that the set up is working as expected</li>
</ol>
<h3 id="ensuring-that-the-server-is-up-to-date"><a
target="_blank" rel="noopener" href="https://citizix.com/how-to-set-up-an-sftp-server-on-arch-linux/#1-ensuring-that-the-server-is-up-to-date">1.
Ensuring that the server is up to date</a></h3>
<p>Before proceeding, ensure your system is up to date. Use this command
to refresh the system packages and update them.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -Syyu</span><br></pre></td></tr></table></figure>
<h3 id="ensuring-that-the-ssh-service-is-installed"><a
target="_blank" rel="noopener" href="https://citizix.com/how-to-set-up-an-sftp-server-on-arch-linux/#2-ensuring-that-the-ssh-service-is-installed">2.
Ensuring that the SSH service is installed</a></h3>
<p>Verify that the ssh is installed:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$ sudo pacman -Qi openssh</span><br><span class="line">Name            : openssh</span><br><span class="line">Version         : 8.6p1-1</span><br><span class="line">Description     : Premier connectivity tool for remote login with the SSH protocol</span><br><span class="line">Architecture    : x86_64</span><br><span class="line">URL             : https://www.openssh.com/portable.html</span><br><span class="line">Licenses        : custom:BSD</span><br><span class="line">Groups          : None</span><br><span class="line">Provides        : None</span><br><span class="line">Depends On      : glibc  krb5  openssl  libedit  ldns  libxcrypt  libcrypt.so=2-64  zlib  pam</span><br><span class="line">Optional Deps   : xorg-xauth: X11 forwarding</span><br><span class="line">                  x11-ssh-askpass: input passphrase in X</span><br><span class="line">                  libfido2: FIDO/U2F support</span><br><span class="line">Required By     : None</span><br><span class="line">Optional For    : None</span><br><span class="line">Conflicts With  : None</span><br><span class="line">Replaces        : None</span><br><span class="line">Installed Size  : 5.79 MiB</span><br><span class="line">Packager        : Giancarlo Razzolini &amp;lt;grazzolini@archlinux.org&amp;gt;</span><br><span class="line">Build Date      : Mon 19 Apr 2021 11:32:46 AM UTC</span><br><span class="line">Install Date    : Thu 03 Jun 2021 03:23:32 AM UTC</span><br><span class="line">Install Reason  : Explicitly installed</span><br><span class="line">Install Script  : Yes</span><br><span class="line">Validated By    : Signature</span><br></pre></td></tr></table></figure>
<p>If ssh is not installed, install with this command:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S openssh</span><br></pre></td></tr></table></figure>
<p>Now that it is installed, start the service</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start sshd</span><br></pre></td></tr></table></figure>
<p>Confirm its status</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl status sshd</span><br><span class="line">● sshd.service - OpenSSH Daemon</span><br><span class="line">     Loaded: loaded (/usr/lib/systemd/system/sshd.service; enabled; vendor preset: disabled)</span><br><span class="line">     Active: active (running) since Fri 2021-12-03 10:19:02 UTC; 17min ago</span><br><span class="line">   Main PID: 467 (sshd)</span><br><span class="line">      Tasks: 1 (limit: 4606)</span><br><span class="line">     Memory: 5.0M</span><br><span class="line">     CGroup: /system.slice/sshd.service</span><br><span class="line">             └─467 sshd: /usr/bin/sshd -D [listener] 0 of 10-100 startups</span><br><span class="line"></span><br><span class="line">Dec 04 14:53:30 ip-10-2-40-103 sshd[13109]: Unable to negotiate with 141.98.10.246 port 34078: no matching key exchange method found. Their offer: diffie-hellman-group14-sha1,diffie-hellman-group-exc&amp;gt;</span><br><span class="line">Dec 04 14:53:42 ip-10-2-40-103 sshd[13111]: Unable to negotiate with 141.98.10.246 port 38674: no matching key exchange method found. Their offer: diffie-hellman-group14-sha1,diffie-hellman-group-exc&amp;gt;</span><br><span class="line">Dec 04 14:53:53 ip-10-2-40-103 sshd[13115]: Unable to negotiate with 141.98.10.246 port 43268: no matching key exchange method found. Their offer: diffie-hellman-group14-sha1,diffie-hellman-group-exc&amp;gt;</span><br><span class="line">Dec 04 14:54:05 ip-10-2-40-103 sshd[13117]: Unable to negotiate with 141.98.10.246 port 47864: no matching key exchange method found. Their offer: diffie-hellman-group14-sha1,diffie-hellman-group-exc&amp;gt;</span><br><span class="line">Dec 04 14:54:17 ip-10-2-40-103 sshd[13119]: Unable to negotiate with 141.98.10.246 port 52460: no matching key exchange method found. Their offer: diffie-hellman-group14-sha1,diffie-hellman-group-exc&amp;gt;</span><br><span class="line">Dec 04 14:54:41 ip-10-2-40-103 sshd[13123]: Unable to negotiate with 141.98.10.246 port 33418: no matching key exchange method found. Their offer: diffie-hellman-group14-sha1,diffie-hellman-group-exc&amp;gt;</span><br><span class="line">Dec 04 14:54:53 ip-10-2-40-103 sshd[13127]: Unable to negotiate with 141.98.10.246 port 38014: no matching key exchange method found. Their offer: diffie-hellman-group14-sha1,diffie-hellman-group-exc&amp;gt;</span><br><span class="line">Dec 04 14:55:05 ip-10-2-40-103 sshd[13129]: Unable to negotiate with 141.98.10.246 port 42614: no matching key exchange method found. Their offer: diffie-hellman-group14-sha1,diffie-hellman-group-exc&amp;gt;</span><br><span class="line">Dec 04 15:16:10 ip-10-2-40-103 sshd[13191]: Received disconnect from 61.177.173.21 port 60983:11:  [preauth]</span><br><span class="line">Dec 04 15:16:10 ip-10-2-40-103 sshd[13191]: Disconnected from authenticating user root 61.177.173.21 port 60983 [preauth]</span><br></pre></td></tr></table></figure>
<h3
id="creating-users-and-groups-and-adding-the-necessary-directories"><a
target="_blank" rel="noopener" href="https://citizix.com/how-to-set-up-an-sftp-server-on-arch-linux/#3-creating-users-and-groups-and-adding-the-necessary-directories">3.
Creating users and groups and adding the necessary directories</a></h3>
<p>Next we will ensure that the necessary users are present in the
system. In my case, I would like to have the sftp users home
as <code>/srv/sftp</code></p>
<p>Let us create the home <code>/srv/sftp</code> with this command:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir /srv/sftp</span><br></pre></td></tr></table></figure>
<p>Then let us create an umbrella group for SFTP only</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo groupadd sftpusers</span><br></pre></td></tr></table></figure>
<p>Then create an sftp only user called citizix:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo useradd -G sftpusers -d /srv/sftp/citizix -s /sbin/nologin citizix</span><br></pre></td></tr></table></figure>
<p>The above options do the following:</p>
<ul>
<li><code>-G sftpusers</code>: Create user, append
to <code>sftpusers</code> group</li>
<li><code>-d /srv/sftp/citizix</code>: Set home dir
as <code>/srv/sftp/citizix</code></li>
<li><code>-s /sbin/nologin</code>: We do not want the user to login, so
no ssh login shell</li>
<li>Finally, username as <code>citizix</code></li>
</ul>
<p>Then add password to the created user using this command:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo passwd citizix</span><br><span class="line">Changing password for user citizix.</span><br><span class="line">New password:</span><br><span class="line">Retype new password:</span><br><span class="line">passwd: all authentication tokens updated successfully.</span><br></pre></td></tr></table></figure>
<h2 id="configuring-the-ssh-service"><a
target="_blank" rel="noopener" href="https://citizix.com/how-to-set-up-an-sftp-server-on-arch-linux/#3-configuring-the-ssh-service">3.
Configuring the ssh service</a></h2>
<p>Now that we have installed the necessary software and created the
users and groups, let us configure ssh.</p>
<p>Ensure password authentication is enabled for ssh. Edit the config
file here <code>/etc/ssh/sshd_config</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure>
<p>Then ensure this line is not commented:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PasswordAuthentication yes</span><br></pre></td></tr></table></figure>
<p>Next, we need to add rules for the users in
the <code>sftpusers</code> group to be considered as sftp. Edit the
config file:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure>
<p>Add this content at the bottom of the file:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Match Group sftpusers  </span><br><span class="line">    X11Forwarding no  </span><br><span class="line">    AllowTcpForwarding no  </span><br><span class="line">    ChrootDirectory /srv/sftp</span><br><span class="line">    ForceCommand internal-sftp</span><br></pre></td></tr></table></figure>
<p>Then restart sshd to reload the config:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart sshd</span><br></pre></td></tr></table></figure>
<p>Verify that <code>sshd</code> is running as expected:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl status sshd</span><br><span class="line">● sshd.service - OpenSSH Daemon</span><br><span class="line">     Loaded: loaded (/usr/lib/systemd/system/sshd.service; enabled; vendor preset: disabled)</span><br><span class="line">     Active: active (running) since Sat 2021-12-04 15:48:19 UTC; 18s ago</span><br><span class="line">   Main PID: 14269 (sshd)</span><br><span class="line">      Tasks: 1 (limit: 4606)</span><br><span class="line">     Memory: 892.0K</span><br><span class="line">     CGroup: /system.slice/sshd.service</span><br><span class="line">             └─14269 sshd: /usr/bin/sshd -D [listener] 0 of 10-100 startups</span><br><span class="line"></span><br><span class="line">Dec 04 15:48:19 ip-10-2-40-103 systemd[1]: Started OpenSSH Daemon.</span><br><span class="line">Dec 04 15:48:19 ip-10-2-40-103 sshd[14269]: Server listening on 0.0.0.0 port 22.</span><br><span class="line">Dec 04 15:48:19 ip-10-2-40-103 sshd[14269]: Server listening on :: port 22.</span><br></pre></td></tr></table></figure>
<h2 id="verifying-that-the-set-up-is-working-as-expected"><a
target="_blank" rel="noopener" href="https://citizix.com/how-to-set-up-an-sftp-server-on-arch-linux/#4-verifying-that-the-set-up-is-working-as-expected">4.
Verifying that the set up is working as expected</a></h2>
<p>After successfully creating the user and adding sftp configurations,
let is test the set up using the command:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">❯ sftp citizix@10.2.11.8</span><br><span class="line">citizix@&amp;lt;meta charset=&quot;utf-8&quot;&amp;gt;10.2.11.8&#x27;s password:</span><br><span class="line">Connected to &amp;lt;meta charset=&quot;utf-8&quot;&amp;gt;10.2.11.8.</span><br><span class="line">sftp&amp;gt;</span><br></pre></td></tr></table></figure>
<p>Now we have sftp server up and running with a user configured!</p>
<p>The users will be able to login to the server and access files and
directories located in their home directory. If you want to give the
user to other directories outside their own directory, just make sure
the user has enough rights to access. These directories and files have
to be within the sftp directory – <code>/srv/sftp</code>.</p>
<p>Example: if i want user to access the
directory <code>/srv/sftp/paymentfiles</code>, do the following:</p>
<p>Create the directory</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir /srv/sftp/paymentfiles</span><br></pre></td></tr></table></figure>
<p>Then assign the user(<code>citizix</code>) access by making them own
the directory:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chown citizix:sftpusers /srv/sftp/paymentfiles</span><br></pre></td></tr></table></figure>
<p>That is it. Users should now have access.</p>
<h4 id="conclusion"><a
target="_blank" rel="noopener" href="https://citizix.com/how-to-set-up-an-sftp-server-on-arch-linux/#conclusion">Conclusion</a></h4>
<p>We managed to set up sftp server in an Archlinux Server in this
guide.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/07/23/%E9%80%9A%E8%BF%87%E7%BD%91%E7%BA%BF%E8%BF%9E%E6%8E%A5%E4%B8%A4%E5%8F%B0%E7%94%B5%E8%84%91%E7%BB%84%E6%88%90%E5%B1%80%E5%9F%9F%E7%BD%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BNU-FZH">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | BNU-FZH">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/23/%E9%80%9A%E8%BF%87%E7%BD%91%E7%BA%BF%E8%BF%9E%E6%8E%A5%E4%B8%A4%E5%8F%B0%E7%94%B5%E8%84%91%E7%BB%84%E6%88%90%E5%B1%80%E5%9F%9F%E7%BD%91/" class="post-title-link" itemprop="url">通过网线连接两台电脑组成局域网</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-07-23 15:22:21" itemprop="dateCreated datePublished" datetime="2024-07-23T15:22:21+08:00">2024-07-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-26 18:21:20" itemprop="dateModified" datetime="2025-03-26T18:21:20+08:00">2025-03-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="为什么需要局域网">为什么需要局域网</h2>
<p>一般工作过程中会有一个台式机电脑和一个笔记本电脑，为了提高效率两台电脑均安装了固态硬盘.
但是我们还会遇到了文件传输的问题,
比如在台式机上的文件需要传输到笔记本电脑上，我们可以借助<code>U盘</code>、<code>移动硬盘</code>、<code>网盘</code>（百度网盘、阿里网盘等），
它们各有优点和不足：</p>
<ul>
<li><code>U盘</code>在转移资料时最方便，但是仅限于对于小文件，如果文件体积过大，那从台式机传输到<code>U盘</code>需要大量的时间，同时从<code>U盘</code>再到笔记本又需要再消耗几乎相同的时间，而且<code>U盘</code>的传输速度一般比较慢，但是它的最大的优点是一旦资料存储在<code>U盘</code>上，那可以方便的携带到其他电脑，实现多次传输。</li>
<li><code>移动硬盘</code>容量比较大，性能要远优于<code>U盘</code>,
一些重要的资料可以保存的上面，但是对于那些需要经常读取和编辑的资料就不适合存放在上面，因为<code>移动硬盘</code>经常随身携带也远不如<code>U盘</code>小巧。但是其传输速度非常快，特别是使用固态硬盘组装的移动硬盘，但是移动硬盘的最大作用应当是备份，备份资料就要求存储介质足够稳定，而目前就价格和稳定性上讲，机械硬盘仍是不二选择，相同价格机械硬盘的容量要远大于固态硬盘，机械硬盘的缺点是在工作时不能随便移动。</li>
<li><code>网盘</code>兴起有好多年了，目前比较有名的有：百度网盘、阿里云盘、坚果云盘、123网盘和中国移动网盘等.
平时可以把资料存在网盘上，但是你不能保证上传和下载速度，同时还有各种广告，各种限制，以及有些涉及隐私的资料都不适合存储在网盘，所以就当前来看这是一个不太明智的作法。</li>
</ul>
<p>综上，在工作中对于那些需要经常访问的资料应当保存的电脑上，同时为了方便在不同电脑中传输，本文提供一个新的方法：使用网线组成局域网，借助<code>samba</code>在局域网中分享文件，分享方法参考：<a
href="/2024/07/23/ArchLinux局域网共享文件">ArchLinux
局域网共享文件</a>.</p>
<div class="note primary"><p>使用移动硬盘等中间媒介时，其传输速度要高于局域网。在测试时，我发现使用局域网传输时速度稳定在<code>60M</code>左右，但是局域网的总速度是<code>1000M</code>，这就意味着可以同时传输多个文件夹，每个传输速度都会在<code>60M</code>左右，显然多线程可以弥补移动硬盘单一高速的优势，但是局域网的点对点的直达优势却是移动硬盘所不具备的.
如果两台电脑处于同一个局域网，或两台电脑就在身边且有一根网线，则推荐使用局域网.
如果两电脑距离较远，且所需资料是不经常编辑的，则推荐使用移动硬盘。</p>
</div>
<h2 id="设置局域网的方法">设置局域网的方法</h2>
<h3 id="准备工作">1. 准备工作</h3>
<p>在开始之前，请准备好：</p>
<ul>
<li>两台运行Ubuntu操作系统的电脑。</li>
<li>一根网线(建议不要超过80米，否则信号会衰减)。</li>
</ul>
<h3 id="连接网线">2. 连接网线</h3>
<p>将网线一端插入第一台电脑的网口，将另一端插入另一电脑的网口。确保网线插紧并且连接稳固。</p>
<h3 id="配置网络">3. 配置网络</h3>
<ul>
<li>打开第一台Ubuntu电脑的系统设置（Settings）。<br />
</li>
<li>选择“网络”（Network）选项。<br />
</li>
<li>在网络设置中，点击“有线连接”（Wired Connection）。<br />
</li>
<li>确保“有线连接”开关处于打开状态。<br />
</li>
<li>选择需要修改的以太网设置，点击右侧的“选项”（Options）按钮（齿轮形的按钮），进入高级网络设置。<br />
</li>
<li>在IPv4设置中，选择“手动”（Manual）。<br />
</li>
<li>点击“添加”按钮，添加一个新的IP地址。<br />
</li>
<li>在“地址”（Address）字段中输入IP地址，例如：<code>192.168.189.13</code>。子网掩码通常为<code>255.255.255.0</code>。<br />
</li>
<li>在“网关”（Gateway）字段中输入网关地址，例如：<code>192.168.189.1</code>。设置完毕的窗口如下图所示：<br />
<img src="https://thumbsnap.com/i/hGjJthMV.png"
alt="置局域网网关" /></li>
<li>点击“应用”并关闭网络设置窗口。</li>
</ul>
<h4 id="解释">解释：</h4>
<p><strong>（1）为什么要设置成<code>192.168.189.13</code>？其他可以吗？</strong><br />
IP地址是<a
target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%B1%80%E5%9F%9F%E7%BD%91&amp;spm=1001.2101.3001.7020">局域网</a>中用来标识设备的地址，而<code>192.168.189.13</code>是IPv4地址中的一个私有地址段，通常用于局域网中。在一个子网内，每台设备的IP地址应该是唯一的，因此我们选择一个未被占用的地址，以便在同一网络中找到对应的设备。其他私有地址段，如<code>192.168.0.0</code>、<code>192.168.1.0</code>等也可以使用，只要保证两台电脑在同一个子网内，并且IP地址唯一。</p>
<p><strong>（2）网关怎么设置？</strong><br />
本教程选择了<code>192.168.189.1</code>这个地址作为网关，是因为它处于私有IP地址范围内（私有IP地址范围是指专门供局域网使用的IP地址范围，不会在全球互联网上被路由器转发），并且与我们选择的IP地址<code>192.168.189.x</code>在同一个子网中。只需要<strong>保证两台电脑上的网关相同</strong>即可。</p>
<p><strong>（3）子网掩码为什么是<code>255.255.255.0</code>？</strong><br />
子网掩码用于定义哪些部分是网络地址，哪些部分是主机地址。在一个局域网中，通常使用的子网掩码是<code>255.255.255.0</code>，这意味着前三个字节是网络地址，最后一个字节是主机地址。这样，同一子网内的设备可以相互通信，而不同子网的设备则需要通过路由器进行通信。</p>
<h3 id="配置第二台电脑">4. 配置第二台电脑</h3>
<p>重复步骤三，但在IPv4设置中将IP地址更改为另一个可用的地址，例如：<code>192.168.189.8</code>。子网掩码为<code>255.255.255.0</code>，网关字段中输入相同的网关地址：<code>192.168.189.1</code>。<br />
<img src="https://thumbsnap.com/i/kYJxZRsK.png"
alt="第二台电脑网关设置" /></p>
<h3 id="测试连接">5. 测试连接</h3>
<p>打开终端，使用ping命令测试两台电脑之间的连接。在第一台电脑上输入以下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping 192.168.189.8</span><br></pre></td></tr></table></figure>
<p>如果一切正常，你应该会收到类似以下的回复：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">64</span> <span class="built_in">bytes</span> <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.189</span><span class="number">.8</span>: icmp_seq=<span class="number">1</span> ttl=<span class="number">64</span> time=<span class="number">0.504</span> ms</span><br></pre></td></tr></table></figure>
<p>在第二台电脑上输入以下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping 192.168.189.13</span><br></pre></td></tr></table></figure>
<p>如果一切正常，你应该会收到类似以下的回复：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">64</span> <span class="built_in">bytes</span> <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.189</span><span class="number">.13</span>: icmp_seq=<span class="number">1</span> ttl=<span class="number">64</span> time=<span class="number">0.425</span> ms</span><br></pre></td></tr></table></figure>
<p>这意味着两台电脑之间的网络连接已经建立并且正常工作。</p>
<div class="note primary"><p>macOS和Windows用户，可以按照类似的步骤进行网线连接和网络配置。在macOS上，你可以打开“系统偏好设置”，选择“网络”，然后配置IP地址、子网掩码和网关等参数。而在Windows操作系统上，可以通过“控制面板”中的“网络和共享中心”来进行相似的设置。（如果无法A可以ping通B，B无法ping通A，请检查A的防火墙设置）</p>
</div>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/07/23/ArchLinux%E5%B1%80%E5%9F%9F%E7%BD%91%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BNU-FZH">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | BNU-FZH">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/23/ArchLinux%E5%B1%80%E5%9F%9F%E7%BD%91%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6/" class="post-title-link" itemprop="url">ArchLinux局域网共享文件</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-07-23 02:36:19" itemprop="dateCreated datePublished" datetime="2024-07-23T02:36:19+08:00">2024-07-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-26 18:21:20" itemprop="dateModified" datetime="2025-03-26T18:21:20+08:00">2025-03-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="安装必备软件">安装必备软件</h2>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> pacman -S nautilus-share</span><br></pre></td></tr></table></figure>
<div class="note primary"><p>注意：安装<code>nautilus-share</code>插件后，<code>pacman</code>将会自动安装上<code>samba</code>等依赖软件,所以仅此一条指令就可以实现<code>gnome3</code>下的<code>nautilus</code>配置共享目录。</p>
</div>
<h2 id="启用用户共享功能">启用用户共享功能</h2>
<p>在用户可以共享目录之前，管理员必须在 Samba
中启用用户共享。本节参考：<a
target="_blank" rel="noopener" href="https://docs.redhat.com/zh_hans/documentation/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/assembly_enabling-users-to-share-directories-on-a-samba-server_assembly_using-samba-as-a-server">3.11.
允许用户在 Samba 服务器上共享目录</a></p>
<p>例如，仅允许本地 example 组的成员创建用户共享：</p>
<ol type="1">
<li><p>如果<code>example</code>不存在，则创建它 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> groupadd example</span><br></pre></td></tr></table></figure></p></li>
<li><p>为<code>Samba</code>准备目录以存储用户共享定义并正确设置其权限。例如：</p>
<ul>
<li><p>创建目录 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">mkdir</span> -p /var/lib/samba/usershares/</span><br></pre></td></tr></table></figure></p></li>
<li><p>为<code>example</code>组设置权限 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">chgrp</span> example /var/lib/samba/usershares/</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">chmod</span> 1770 /var/lib/samba/usershares/</span><br></pre></td></tr></table></figure></p></li>
<li><p>设置粘性位以防止用户重命名或删除此目录中其他用户存储的文件。</p></li>
</ul></li>
<li><p>若<code>/etc/samba/smb.conf</code>文件不存在，则参考<a
target="_blank" rel="noopener" href="https://github.com/samba-team/samba/blob/master/examples/smb.conf.default">smb.conf.default</a>建立<code>smb.conf</code>，并将以下内容添加到<code>[global]</code>部分(默认配置中并没有这两项)：</p>
<ul>
<li><p>设置您配置用来存储用户共享定义的目录的路径。例如：
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usershare path = /var/lib/samba/usershares/</span><br></pre></td></tr></table></figure></p></li>
<li><p>设置允许在这个服务器上创建多少个用户共享
<code>Samba</code>。例如： <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usershare max shares = 100</span><br></pre></td></tr></table></figure></p></li>
</ul>
<p>如果您对 usershare max shares 参数使用默认值
0，则用户共享将被禁用。</p></li>
<li><p>验证<code>/etc/samba/smb.conf</code>文件 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">testparm</span><br></pre></td></tr></table></figure></p></li>
<li><p>重新载入<code>Samba</code>配置 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> smbcontrol all reload-config</span><br></pre></td></tr></table></figure></p></li>
</ol>
<p>用户现在可以创建用户共享。</p>
<ol start="6" type="1">
<li>支持软链接访问（可选）</li>
</ol>
<p>在<code>/etc/samba/smb.conf</code>的<code>[global]</code>节的最后，加上下面三条设置：
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">follow symlinks = yes</span><br><span class="line">wide links = yes</span><br><span class="line">unix extensions = no</span><br></pre></td></tr></table></figure></p>
<ol start="7" type="1">
<li>重启<code>samba</code>服务 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl restart smb</span><br></pre></td></tr></table></figure></li>
</ol>
<p>参考文章: <a
target="_blank" rel="noopener" href="https://www.cnblogs.com/xl2432/p/10121982.html">Ubuntu配置samba服务器</a></p>
<h2 id="archlinux-中共享文件夹的步骤">ArchLinux 中共享文件夹的步骤</h2>
<p><strong>步骤
1：</strong> 打开文件管理器，右键单击共享的文件夹。点击上下文菜单中的“本地网络共享”选项。</p>
<figure>
<img
src="https://img.linux.net.cn/data/attachment/album/202207/21/104756l9yr8gb1gbc264h5.jpg"
alt="本地网络共享选项" />
<figcaption aria-hidden="true">本地网络共享选项</figcaption>
</figure>
<p><strong>步骤
2：</strong> 在文件夹共享对话框中点击共享文件夹复选框。</p>
<p>这将在你的系统中安装 <a
target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Samba_(software)">Samba</a> 软件包。Samba
用于在 Windows 和 Unix 系统之间通过网络共享文件和打印机。</p>
<figure>
<img
src="https://img.linux.net.cn/data/attachment/album/202207/21/104915uzihpx9j99pibvv0.jpg"
alt="文件夹共享选项 - 安装 Samba" />
<figcaption aria-hidden="true">文件夹共享选项 - 安装 Samba</figcaption>
</figure>
<p><strong>步骤 3：</strong> 安装 Samba
后，执行以下操作共享文件夹或目录。</p>
<ul>
<li>选中共享文件夹复选框。</li>
<li>输入共享名称。这将是你从另一个系统（如
Windows）看到的名称。尽量不要使用任何带有空格的名称。</li>
<li>（可选）通过勾选相应选项，你可以控制共享文件夹的写入权限，以及允许访客访问。</li>
<li>如果你允许访客访问，则没有凭据的人可以访问共享文件夹。所以要谨慎。</li>
<li>如果你希望用户输入用户名和密码，打开终端并运行以下命令。</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> smbpasswd -a 用户名</span><br></pre></td></tr></table></figure>
<p><code>用户名</code> 应该是对应 ArchLinux 系统的有效用户。</p>
<p>现在，你应该已经设置好了共享的文件夹或目录。</p>
<h2 id="如何访问共享文件夹">如何访问共享文件夹</h2>
<p>从 Linux 系统中访问共享文件夹，你需要系统的 IP
地址或主机名。为此，打开“系统设置System Settings -&gt; Wi-Fi -&gt; 获取
IP 地址Get the IP address”。</p>
<figure>
<img
src="https://img.linux.net.cn/data/attachment/album/202207/21/104934qb6w6px0pi8x6b6q.jpg"
alt="IP 地址设置" />
<figcaption aria-hidden="true">IP 地址设置</figcaption>
</figure>
<p>如果你运行的是 Linux 发行版不是
Ubuntu，此步骤略有不同。你可能想运行 <code>ip addr</code> 来获取 IP
地址，如下所示：</p>
<figure>
<img
src="https://img.linux.net.cn/data/attachment/album/202207/21/104757kmcw3ace3dmdd7ea.jpg"
alt="在 Linux 中查找 IP 地址" />
<figcaption aria-hidden="true">在 Linux 中查找 IP 地址</figcaption>
</figure>
<p>一旦你获得 IP 地址，就可以在 Linux
系统中打开<code>文件管理器</code>，然后在地址栏中输入以下内容。注意：<code>你应该修改为你系统的 IP 地址</code>。</p>
<p>你现在可以看到共享文件夹上面显示了一个小共享图标，表示网络共享文件夹。</p>
<figure>
<img
src="https://img.linux.net.cn/data/attachment/album/202207/21/104947l7wn6owul4447ll7.jpg"
alt="共享文件夹" />
<figcaption aria-hidden="true">共享文件夹</figcaption>
</figure>
<p>要在 <strong>Windows
系统</strong> 访问共享文件夹，打开运行（按下 <code>Windows + R</code>）或打开资源管理器，输入以下地址。注意：你应该修改为你系统的
IP 地址和文件夹名称。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\\192.168.43.19\Folder</span><br></pre></td></tr></table></figure>
<p>你应该能够查看共享文件夹的内容，并根据授予的权限修改它。本节参考：<a
target="_blank" rel="noopener" href="https://linux.cn/article-14850-1.html">如何在 Ubuntu/Linux 和
Windows 之间共享文件夹</a></p>
<h2 id="关闭-samba-异步提高网速">关闭 samba 异步提高网速</h2>
<p>默认情况下，<code>Samba</code>写操作是异步的，这导致了读取速度减半。在千兆局域网速下，<code>Samba</code>写入速度应当在<code>100m/s</code>,
但是读取速度只有<code>50m/s</code>, 解决方法为：关闭异步,
在配置文件<code>/etc/samba/smb.conf</code> 的
<code>[global]</code>节点下追加上如下代码</p>
<figure class="highlight txt"><figcaption><span>/etc/samba/smb.conf -- [global]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aio read size = 0</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/07/20/%E7%94%B5%E8%84%91%E5%86%85%E5%AD%98%E6%9D%A1%E7%9A%84%E9%80%89%E6%8B%A9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BNU-FZH">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | BNU-FZH">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/20/%E7%94%B5%E8%84%91%E5%86%85%E5%AD%98%E6%9D%A1%E7%9A%84%E9%80%89%E6%8B%A9/" class="post-title-link" itemprop="url">电脑内存条的选择</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-07-20 17:27:01" itemprop="dateCreated datePublished" datetime="2024-07-20T17:27:01+08:00">2024-07-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-26 18:21:20" itemprop="dateModified" datetime="2025-03-26T18:21:20+08:00">2025-03-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>在购买内存时, 如果你的主板只有两个内存插槽，你应该选择购买一条
<code>16GB</code> 的内存还是两条 <code>8GB</code>
的内存呢？当预算有限时，我们需要做出抉择。</p>
<h2 id="内存容量大有什么优势">内存容量大有什么优势</h2>
<p>简单来说，不同内存配置的差异在于，一条<code>16GB</code>内存的价格较便宜，并且占用的内存插槽较少。而两条<code>8G</code>内存的优势在于可以启用双通道技术，从而在一定程度上提升性能。计算机在工作时，CPU直接与内存交换数据，内存容量越大，能够存放更多的文件进行处理，并提供更大的空间用于与<code>CPU</code>交换数据，从而更轻松地处理大型软件和多任务。</p>
<h2 id="双通道内存有什么优势">双通道内存有什么优势</h2>
<p>内存的读写速度也会影响电脑的运行速度。双通道内存具备更大的带宽，可以实现更快的内存读取速度。虽然<label style="color:red">效果不会明显翻倍</label>，但在使用<label style="color:red">核显</label>时，可以<label style="color:red">明显感觉到双通道内存的不同</label>。特别强调的是，<label style="color:blue">双通道内存对于核显来说效果非常显著</label>，许多游戏的帧数可以提升<code>50%</code>甚至更多。而对于<label style="color:red">独立显卡</label>来说，双通道内存的帧数提升则<label style="color:red">相对有限</label>，因此<label style="color:blue">使用独立显卡的玩家可以不过分追求双通道内存!!</label>。</p>
<h2 id="先保证大内存还是先保证双通道">先保证大内存还是先保证双通道</h2>
<p>了解了前述知识点后，我们可以得出结论:</p>
<ul>
<li>如果你使用的是核显，并且没有独立显卡，一定要选择两条8GB内存以实现双通道，尤其是对于有游戏和图像处理需求的用户来说，这一点要优先考虑。</li>
<li>如果你使用的是独立显卡，并且主板具备四个内存插槽，同样推荐选择两条8GB内存，因为这样还能保留两个内存插槽供未来升级使用。</li>
<li>如果你的主板只有两个内存插槽，并且你担心将来的内存升级，那么在使用独立显卡的情况下，选择一条16GB内存也是可以的，因为<label style="color:red">双通道内存带来的性能提升并不明显</label>。</li>
</ul>
<div class="note primary"><p>此外，还要注意内存的兼容性，一些较大尺寸的散热器安装后可能会挤占内存插槽的空间，如果主板因此减少了两个内存插槽，那就只能考虑更换硬件了。总之，根据自己的需求和经济情况，选择合适的内存配置是非常重要的。无论是单条16GB还是双条8GB，都有各自的优势和适用场景，希望上述的解释能对DIY玩家们在购买内存时有所帮助。</p>
</div>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/07/19/Linux%E8%BD%AF%E4%BB%B6%E7%9A%84%E5%AE%89%E8%A3%85%E7%9B%AE%E5%BD%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BNU-FZH">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | BNU-FZH">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/19/Linux%E8%BD%AF%E4%BB%B6%E7%9A%84%E5%AE%89%E8%A3%85%E7%9B%AE%E5%BD%95/" class="post-title-link" itemprop="url">Linux软件的安装目录</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-07-19 20:43:54" itemprop="dateCreated datePublished" datetime="2024-07-19T20:43:54+08:00">2024-07-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-26 18:21:20" itemprop="dateModified" datetime="2025-03-26T18:21:20+08:00">2025-03-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="linux目录与windows目录类比">Linux目录与Windows目录类比</h3>
<ul>
<li><code>/usr</code>：系统级的目录，可以理解为<code>C:/Windows/</code>，<code>/usr/lib</code>理解为<code>C:/Windows/System32</code>。</li>
<li><code>/usr/local</code>：用户级的程序目录，可以理解为<code>C:/Progrem Files/</code>。用户自己编译的软件默认会安装到这个目录下。</li>
<li><code>/opt</code>：用户级的程序目录，可以理解为<code>D:/Software</code>，<code>opt</code>有可选的意思，这里可以用于放置第三方大型软件（或游戏），当你不需要时，直接<code>rm -rf</code>掉即可。在硬盘容量不够时，也可将<code>/opt</code>单独挂载到其他磁盘上使用。</li>
</ul>
<h3 id="源码的安装位置">源码的安装位置</h3>
<ul>
<li><code>/usr/src</code>：系统级的源码目录。</li>
<li><code>/usr/local/src</code>：用户级的源码目录。</li>
</ul>
<h3 id="opt">/opt</h3>
<p>这里主要存放那些可选的程序。例如测试最新的<code>firefox</code>,
那就装到<code>/opt</code>目录，<strong>当你测试完，直接删除它即可，这不影响系统其他任何设置。</strong>安装到<code>/opt</code>目录下的程序，它所有的数据、库文件等等都是放在同个目录下面。
举个例子：刚才装的测试版<code>firefox</code>，就可以装到<code>/opt/firefox_beta</code>目录下，<code>/opt/firefox_beta</code>目录下面就包含了运
行<code>firefox</code>所需要的所有文件、库、数据等等。要删除<code>firefox</code>的时候，你只需删除<code>/opt/firefox_beta</code>目录即可，非常简单。</p>
<h3 id="usrlocal">/usr/local</h3>
<p>这里主要存放那些<label style="color:red">手动安装</label>的软件，<strong>即不是通过“包管理器”安装的软件。它和<code>/usr</code>目录具有相类似的目录结构</strong>。让软件包管理器来管理<code>/usr</code>目录，而把自定义的脚本(<code>scripts</code>)放到<code>/usr/local</code>目录下面是个不错的主意。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/07/19/Windows%E6%94%AF%E6%8C%81%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E5%8F%8A%E5%85%B6%E7%89%B9%E7%82%B9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BNU-FZH">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | BNU-FZH">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/19/Windows%E6%94%AF%E6%8C%81%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E5%8F%8A%E5%85%B6%E7%89%B9%E7%82%B9/" class="post-title-link" itemprop="url">Windows支持的三种文件格式及其特点</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-07-19 17:01:51" itemprop="dateCreated datePublished" datetime="2024-07-19T17:01:51+08:00">2024-07-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-26 18:21:20" itemprop="dateModified" datetime="2025-03-26T18:21:20+08:00">2025-03-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>exFAT很好，MAC、WIN都支持，还可以支持大硬盘和大文件
，但它有一个问题，有时会很严重。如果你拿它存电影、音乐等，或者暴雪的游戏，都没关系，都是大文件。如果你拿它存一堆小文件，每个不超过128K，问题就出现了。</p>
<p>1T硬盘，一个分区:</p>
<ul>
<li>NTFS每个簇4K，就是说你的文件要是10K，占三个簇，浪费2K。<br />
</li>
<li>exFAT每个簇256K，10K的文件占一个簇，浪费246K。</li>
</ul>
<p>曾经在装的一个cygwin，4.8G:</p>
<ul>
<li>在NTFS分区，占5.2G，还好。<br />
</li>
<li>在exFAT分区，大概占50G吧，因为多数文件都只有几十K甚至不到1K。</li>
</ul>
<p>在NTFS里只占不到400G的数据（各种文件，电影、游戏、文档、程序源文件等），移到exFAT都快600G了。</p>
<p>exFAT分区小于512G的话，每个簇128K，还稍微节约一点，所以可以分至少两个区，每个512G。</p>
<p>一个NTFS，存放一堆小文件，或者变化不大的文件，可以用虚拟机里的WIN系统来修改。另一个是exFAT，放大文件或经常修改的文件。还有一个方案就是把一堆小文件弄成磁盘映像，DMG或ISO，只要装载了就可以直接用，但里面的内容不方便修改。存成压缩文件亦可，都不会显出exFAT的问题。</p>
<p>在格式化U盘的时候，会有一个U盘格式的选择，一般是两个，有的是三个，FAT32/exFAT/NTFS，那么这三个格式具体有什么区别呢？相信很多人都知道如果要拷贝超过4G大小的文件就得用NTFS格式，但其实他们之间的区别可不只这个。</p>
<p>首先先给大家介绍下这三种格式的特点。</p>
<h2 id="fat32"><strong>FAT32</strong></h2>
<p>FAT32文件系统用4个字节（32位）空间来表示每个扇区配置文件的情形，所以叫FAT32。分区容量最低是512M，而上限的话不同的操作系统都不一样，WinXP系统最大可以做到2TB的FAT32分区。</p>
<h2 id="ntfs"><strong>NTFS</strong></h2>
<p>NTFS文件系统是windows
NT核心和高级服务器网络操作系统环境的文件系统。NTFS系统比FAT32的可靠性更高，可以支持更大的分区和更大的文件，此外还有不少FAT32没有的功能，比如压缩分区、文件索引、数据保护和恢复、加密访问等。</p>
<h2 id="exfat"><strong>exFAT</strong></h2>
<p>exFAT文件系统是微软在windows
embeded5.0以上引入的一种适合于闪存的文件系统，主要是为了解决FAT32不支持4G或更大文件的问题而推出的。</p>
<h2
id="fat32与exfat可用4gb文件的区别"><strong>FAT32与exFAT可用4GB文件的区别：</strong></h2>
<p>大多数优盘在格式化时默认FAT32，最大优点就是在一个不超过8GB的分区中，FAT32的每个簇容量都固定为4KB，与前代相比可以大大地减少磁盘的浪费，提高磁盘利用率。</p>
<p>虽然对于最大分区容量的支持上面，FAT32的2TB最大分区容量至今仍不过时，但FAT32无法传输并存放超过4GB容量的光盘ISO镜像、高清视频、各种图形作品文件等等，这是最致命的弊端。而exFAT格式在苹果本或者是Windows电脑上都可以格式化，并且在两个系统之间可以互相无障碍使用。相比之下，exFAT格式就没有4GB文件传输限制了。</p>
<p>其实FAT32与exFAT存在着一个升级关系，这两种文件系统都支持OS
X系统与Windows系统，如果你将U盘格式化成这两种文件系统，在不同操作系统电脑上可以畅通无阻地使用。</p>
<h2
id="ntfs相比fat会让闪存性能降低"><strong>NTFS相比FAT会让闪存性能降低</strong></h2>
<p>NTFS是相当流行的，但多见于硬盘。XP、Vista、Win7默认都会将分区格式化为NTFS系统，可以说NTFS是目前最好的磁盘文件系统。</p>
<p>优盘在格式化为NTFS时，实际可用容量与其他文件系统形式也有所差别，虽然使用中感受并不是很大。另外，在格式化U盘时，容量在64G甚至更大规格时，系统识别自动格式化为exFAT与NTFS格式，会便于优盘在不同操作系统电脑上无障碍使用。</p>
<p>但是，NTFS也有他的缺点，NTFS分区采用“日志式”，因为要记录磁盘的详细读写操作，对U盘这种快闪存储介质会造成较大的负担，比如同样存取一个文件或目录，在NTFS上的读写次数就会比FAT32更多，理论上NTFS格式的U盘比较容易损坏。并且由于U盘带宽有限，NTFS频繁读写占据通道会让磁盘性能降低。</p>
<p>以上便是关于U盘文件系统FAT32、exFAT、NTFS之间的区别和特点介绍，FAT32与exFAT之间最大的差别在于能否支持4GB及以上容量单个文件的传输、查看与编辑；而FAT系列文件系统与NTFS之间最大的区分在于文件存取的方式，后者长期使用可能会让闪存类存储产品性能降低.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/07/18/Python%E7%89%88CUDA%E6%95%99%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BNU-FZH">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | BNU-FZH">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/18/Python%E7%89%88CUDA%E6%95%99%E7%A8%8B/" class="post-title-link" itemprop="url">Python版CUDA教程</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-07-18 14:48:24" itemprop="dateCreated datePublished" datetime="2024-07-18T14:48:24+08:00">2024-07-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-26 18:21:20" itemprop="dateModified" datetime="2025-03-26T18:21:20+08:00">2025-03-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>本文主要介绍<code>CUDA</code>编程的基本流程和核心概念，并使用<code>Python Numba</code>编写<code>GPU</code>并行程序。</p>
<ol type="1">
<li><p><a href="/2024/07/18/GPU硬件知识和基础概念"
title="https://juejin.cn/post/6844904000165249032">GPU硬件知识和基础概念</a>：包括CPU与GPU的区别、GPU架构、CUDA软件栈简介。</p></li>
<li><p>GPU编程入门：主要介绍CUDA核函数，Thread、Block和Grid概念，并使用Python
Numba进行简单的并行计算。</p></li>
<li><p>GPU编程进阶：主要介绍一些优化方法。</p></li>
<li><p>GPU编程实践：使用Python Numba解决复杂问题。</p></li>
</ol>
<h2 id="针对python的cuda教程">针对Python的CUDA教程</h2>
<p>Python是当前最流行的编程语言，被广泛应用在深度学习、金融建模、科学和工程计算上。作为一门解释型语言，它运行速度慢也常常被用户诟病。著名Python发行商Anaconda公司开发的Numba库为程序员提供了Python版CPU和GPU编程工具，速度比原生Python快数十倍甚至更多。使用Numba进行GPU编程，你可以享受：</p>
<ol type="1">
<li>Python简单易用的语法；</li>
<li>极快的开发速度；</li>
<li>成倍的硬件加速。</li>
</ol>
<p>为了既保证Python语言的易用性和开发速度，又达到并行加速的目的，本系列主要从Python的角度给大家分享GPU编程方法。关于Numba的入门可以参考我的另一篇文章。<strong>更加令人兴奋的是，Numba提供了一个GPU模拟器，即使你手头暂时没有GPU机器，也可以先使用这个模拟器来学习GPU编程！</strong></p>
<h2 id="初识gpu编程">初识GPU编程</h2>
<p>兵马未动，粮草先行。在开始GPU编程前，需要明确一些概念，并准备好相关工具。</p>
<p>CUDA是英伟达提供给开发者的一个GPU编程框架，程序员可以使用这个框架轻松地编写并行程序。本系列第一篇文章提到，CPU和主存被称为<strong>主机（Host）</strong>，GPU和显存（显卡内存）被称为<strong>设备（Device）</strong>，CPU无法直接读取显存数据，GPU无法直接读取主存数据，主机与设备必须通过总线（Bus）相互通信。</p>
<figure>
<img
src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/11/20/16e86a62c580871e~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.png"
alt="GPU和CPU架构" />
<figcaption aria-hidden="true">GPU和CPU架构</figcaption>
</figure>
<p>在进行GPU编程前，需要先确认是否安装了CUDA工具箱，可以使用<code>echo $CUDA_HOME</code>检查CUDA环境变量，返回值不为空说明已经安装好CUDA。也可以直接用Anaconda里的<code>conda</code>命令安装CUDA：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ conda install cudatoolkit</span><br></pre></td></tr></table></figure>
<p>然后可以使用<code>nvidia-smi</code>命令查看显卡情况，比如这台机器上几张显卡，CUDA版本，显卡上运行的进程等。我这里是一台32GB显存版的Telsa
V100机器。</p>
<figure>
<img
src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/11/20/16e86a62c5992567~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.png"
alt="nvidia-smi命令返回结果" />
<figcaption aria-hidden="true">nvidia-smi命令返回结果</figcaption>
</figure>
<p>安装Numba库：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ conda install numba</span><br></pre></td></tr></table></figure>
<p>检查一下CUDA和Numba是否安装成功：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">from numba import cuda</span><br><span class="line"><span class="built_in">print</span>(cuda.gpus)</span><br></pre></td></tr></table></figure>
<p>如果上述步骤没有问题，可以得到结果：<code>&lt;Managed Device 0&gt;...</code>。如果机器上没有GPU或没安装好上述包，会有报错。CUDA程序执行时会独霸一张卡，如果你的机器上有多张GPU卡，CUDA默认会选用0号卡。如果你与其他人共用这台机器，最好协商好谁在用哪张卡。一般使用<code>CUDA_VISIBLE_DEVICES</code>这个环境变量来选择某张卡。如选择5号GPU卡运行你的程序。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CUDA_VISIBLE_DEVICES=<span class="string">&#x27;5&#x27;</span> python example.py</span><br></pre></td></tr></table></figure>
<p>如果手头暂时没有GPU设备，Numba提供了一个模拟器，供用户学习和调试，只需要在命令行里添加一个环境变量。</p>
<p><strong>Mac/Linux:</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> NUMBA_ENABLE_CUDASIM=1</span><br></pre></td></tr></table></figure>
<p><strong>Windows:</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET NUMBA_ENABLE_CUDASIM=1</span><br></pre></td></tr></table></figure>
<p>需要注意的是，模拟器只是一个调试的工具，在模拟器中使用Numba并不能加速程序，有可能速度更慢，而且在模拟器能够运行的程序，并不能保证一定能在真正的GPU上运行，最终还是要以GPU为准。</p>
<p>有了以上的准备工作，我们就可以开始我们的GPU编程之旅了！</p>
<h2 id="gpu程序与cpu程序的区别">GPU程序与CPU程序的区别</h2>
<p>一个传统的CPU程序的执行顺序如下图所示：</p>
<figure>
<img
src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/11/20/16e86a62c5ab32b3~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.png"
alt="CPU程序执行流程" />
<figcaption aria-hidden="true">CPU程序执行流程</figcaption>
</figure>
<p>CPU程序是顺序执行的，一般需要：</p>
<ol type="1">
<li><p>初始化。</p></li>
<li><p>CPU计算。</p></li>
<li><p>得到计算结果。</p></li>
</ol>
<p>在CUDA编程中，CPU和主存被称为主机（Host），GPU被称为设备（Device）。</p>
<figure>
<img
src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/11/20/16e86a62c5b7a913~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.png"
alt="GPU程序执行流程" />
<figcaption aria-hidden="true">GPU程序执行流程</figcaption>
</figure>
<p>当引入GPU后，计算流程变为：</p>
<ol type="1">
<li>初始化，并将必要的数据拷贝到GPU设备的显存上。</li>
<li>CPU调用GPU函数，启动GPU多个核心同时进行计算。</li>
<li>CPU与GPU异步计算。</li>
<li>将GPU计算结果拷贝回主机端，得到计算结果。</li>
</ol>
<p>一个名为<code>gpu_print.py</code>的GPU程序如下所示：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> numba <span class="keyword">import</span> cuda</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cpu_print</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;print by cpu.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@cuda.jit</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gpu_print</span>():</span><br><span class="line">    <span class="comment"># GPU核函数</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;print by gpu.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    gpu_print[<span class="number">1</span>, <span class="number">2</span>]()</span><br><span class="line">    cuda.synchronize()</span><br><span class="line">    cpu_print()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>使用<code>CUDA_VISIBLE_DEVICES='0' python gpu_print.py</code>执行这段代码，得到的结果为：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span> by gpu.</span><br><span class="line"><span class="built_in">print</span> by gpu.</span><br><span class="line"><span class="built_in">print</span> by cpu.</span><br></pre></td></tr></table></figure>
<p>与传统的Python CPU代码不同的是：</p>
<ul>
<li>使用<code>from numba import cuda</code>引入<code>cuda</code>库</li>
<li>在GPU函数上添加<code>@cuda.jit</code>装饰符，表示该函数是一个在GPU设备上运行的函数，GPU函数又被称为<strong>核函数</strong>。</li>
<li>主函数调用GPU核函数时，需要添加如<code>[1, 2]</code>这样的<strong>执行配置</strong>，这个配置是在告知GPU以多大的并行粒度同时进行计算。<code>gpu_print[1, 2]()</code>表示同时开启2个线程并行地执行<code>gpu_print</code>函数，函数将被并行地执行2次。下文会深入探讨如何设置执行配置。</li>
<li>GPU核函数的启动方式是<strong>异步</strong>的：启动GPU函数后，CPU不会等待GPU函数执行完毕才执行下一行代码。必要时，需要调用<code>cuda.synchronize()</code>，告知CPU等待GPU执行完核函数后，再进行CPU端后续计算。这个过程被称为<strong>同步</strong>，也就是GPU执行流程图中的红线部分。如果不调用<code>cuda.synchronize()</code>函数，执行结果也将改变，"print
by
cpu.将先被打印。虽然GPU函数在前，但是程序并没有等待GPU函数执行完，而是继续执行后面的<code>cpu_print</code>函数，由于CPU调用GPU有一定的延迟，反而后面的<code>cpu_print</code>先被执行，因此<code>cpu_print</code>的结果先被打印了出来。</li>
</ul>
<h2 id="thread层次结构">Thread层次结构</h2>
<p>前面的程序中，核函数被GPU并行地执行了2次。在进行GPU并行编程时需要定义执行配置来告知以怎样的方式去并行计算，比如上面打印的例子中，是并行地执行2次，还是8次，还是并行地执行20万次，或者2000万次。2000万的数字��大，远远多于GPU的核心数，如何将2000万次计算合理分配到所有GPU核心上。解决这些问题就需要弄明白CUDA的Thread层次结构。</p>
<figure>
<img
src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/11/20/16e86a62c5c7d4d6~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.png"
alt="并行执行8次的执行配置" />
<figcaption aria-hidden="true">并行执行8次的执行配置</figcaption>
</figure>
<p>CUDA将核函数所定义的运算称为<strong>线程（Thread）</strong>，多个线程组成一个<strong>块（Block）</strong>，多个块组成<strong>网格（Grid）</strong>。这样一个grid可以定义成千上万个线程，也就解决了并行执行上万次操作的问题。例如，把前面的程序改为并行执行8次：可以用2个block，每个block中有4个thread。原来的代码可以改为<code>gpu_print[2, 4]()</code>，其中方括号中第一个数字表示整个grid有多少个block，方括号中第二个数字表示一个block有多少个thread。</p>
<p>实际上，线程（thread）是一个编程上的软件概念。从硬件来看，thread运行在一个CUDA核心上，多个thread组成的block运行在Streaming
Multiprocessor（SM的概念详见本系列第一篇文章），多个block组成的grid运行在一个GPU显卡上。</p>
<figure>
<img
src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/11/20/16e86a62e8d3594b~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.png"
alt="软硬件对应关系" />
<figcaption aria-hidden="true">软硬件对应关系</figcaption>
</figure>
<p>CUDA提供了一系列内置变量，以记录thread和block的大小及索引下标。以<code>[2, 4]</code>这样的配置为例：<code>blockDim.x</code>变量表示block的大小是4，即每个block有4个thread，<code>threadIdx.x</code>变量是一个从0到<code>blockDim.x - 1</code>（4-1=3）的索引下标，记录这是第几个thread；<code>gridDim.x</code>变量表示grid的大小是2，即每个grid有2个block，<code>blockIdx.x</code>变量是一个从0到<code>gridDim.x - 1</code>（2-1=1）的索引下标，记录这是第几个block。</p>
<figure>
<img
src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/11/20/16e86a62e6bf29ca~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.png"
alt="CUDA内置变量示意图" />
<figcaption aria-hidden="true">CUDA内置变量示意图</figcaption>
</figure>
<p>某个thread在整个grid中的位置编号为：<code>threadIdx.x + blockIdx.x * blockDim.x</code>。</p>
<figure>
<img
src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/11/20/16e86a62eeccd9cb~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.png"
alt="使用内置变量计算某个thread编号" />
<figcaption
aria-hidden="true">使用内置变量计算某个thread编号</figcaption>
</figure>
<p>利用上述变量，我们可以把之前的代码丰富一下：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">``<span class="keyword">from</span> numba <span class="keyword">import</span> cuda</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cpu_print</span>(<span class="params">N</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, N):</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line"></span><br><span class="line"><span class="meta">@cuda.jit</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gpu_print</span>(<span class="params">N</span>):</span><br><span class="line">    idx = cuda.threadIdx.x + cuda.blockIdx.x * cuda.blockDim.x </span><br><span class="line">    <span class="keyword">if</span> (idx &lt; N):</span><br><span class="line">        <span class="built_in">print</span>(idx)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;gpu print:&quot;</span>)</span><br><span class="line">    gpu_print[<span class="number">2</span>, <span class="number">4</span>](<span class="number">8</span>)</span><br><span class="line">    cuda.synchronize()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;cpu print:&quot;</span>)</span><br><span class="line">    cpu_print(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()`</span><br><span class="line"></span><br><span class="line">执行结果为：</span><br><span class="line"></span><br><span class="line">```py</span><br><span class="line">``gpu <span class="built_in">print</span>:</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">7</span></span><br><span class="line">cpu <span class="built_in">print</span>:</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">7</span>`</span><br><span class="line"></span><br><span class="line">这里的GPU函数在每个CUDA thread中打印了当前thread的编号，起到了CPU函数`<span class="keyword">for</span>`循环同样的作用。因为`<span class="keyword">for</span>`循环中的计算内容互相不依赖，也就是说，某次循环只是专心做自己的事情，循环第i次不影响循环第j次的计算，所以这样互相不依赖的`<span class="keyword">for</span>`循环非常适合放到CUDA thread里做并行计算。在实际使用中，我们一般将CPU代码中互相不依赖的的`<span class="keyword">for</span>`循环适当替换成CUDA代码。</span><br><span class="line"></span><br><span class="line">这份代码打印了<span class="number">8</span>个数字，核函数有一个参数`N`，`N = <span class="number">8</span>`，假如我们只想打印<span class="number">5</span>个数字呢？当前的执行配置共<span class="number">2</span> \* <span class="number">4</span> = <span class="number">8</span>个线程，线程数<span class="number">8</span>与要执行的次数<span class="number">5</span>不匹配，不过我们已经在代码里写好了`<span class="keyword">if</span> (idx &lt; N)`的判断语句，判断会帮我们过滤不需要的计算。我们只需要把`N = <span class="number">5</span>`传递给`gpu_print`函数中就好，CUDA仍然会启动<span class="number">8</span>个thread，但是大于等于`N`的thread不进行计算。==注意，当线程数与计算次数不一致时，一定要使用这样的判断语句，以保证某个线程的计算不会影响其他线程的数据。==</span><br><span class="line"></span><br><span class="line">![线程数与计算次数不匹配](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/<span class="number">2019</span>/<span class="number">11</span>/<span class="number">20</span>/16e86a62f739c803~tplv-t2oaga2asx-jj-mark:<span class="number">3024</span>:<span class="number">0</span>:<span class="number">0</span>:<span class="number">0</span>:q75.png)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Block大小设置</span></span><br><span class="line"></span><br><span class="line">不同的执行配置会影响GPU程序的速度，一般需要多次调试才能找到较好的执行配置，在实际编程中，执行配置`[gridDim, blockDim]`应参考下面的方法：</span><br><span class="line"></span><br><span class="line">-   block运行在SM上，不同硬件架构（Turing、Volta、Pascal...）的CUDA核心数不同，一般需要根据当前硬件来设置block的大小`blockDim`（执行配置中第二个参数）。一个block中的thread数最好是<span class="number">32</span>、<span class="number">128</span>、<span class="number">256</span>的倍数。==注意，限于当前硬件的设计，block大小不能超过<span class="number">1024</span>。==</span><br><span class="line">-   grid的大小`gridDim`（执行配置中第一个参数），即一个grid中block的个数可以由总次数`N`除以`blockDim`，并向上取整。</span><br><span class="line"></span><br><span class="line">例如，我们想并行启动<span class="number">1000</span>个thread，可以将blockDim设置为<span class="number">128</span>，`<span class="number">1000</span> ÷ <span class="number">128</span> = <span class="number">7.8</span>`，向上取整为<span class="number">8</span>。使用时，执行配置可以写成`gpuWork[<span class="number">8</span>, <span class="number">128</span>]()`，CUDA共启动`<span class="number">8</span> * <span class="number">128</span> = <span class="number">1024</span>`个thread，实际计算时只使用前<span class="number">1000</span>个thread，多余的<span class="number">24</span>个thread不进行计算。</span><br><span class="line"></span><br><span class="line">注意，这几个变量比较容易混淆，再次明确一下：`blockDim`是block中thread的个数，一个block中的`threadIdx`最大不超过`blockDim`；`gridDim`是grid中block的个数，一个grid中的`blockIdx`最大不超过`gridDim`。</span><br><span class="line"></span><br><span class="line">以上讨论中，block和grid大小均是一维，实际编程使用的执行配置常常更复杂，block和grid的大小可以设置为二维甚至三维，如下图所示。这部分内容将在下篇文章中讨论。</span><br><span class="line"></span><br><span class="line">![Thread Block Grid](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/<span class="number">2019</span>/<span class="number">11</span>/<span class="number">20</span>/16e86a62ef74074b~tplv-t2oaga2asx-jj-mark:<span class="number">3024</span>:<span class="number">0</span>:<span class="number">0</span>:<span class="number">0</span>:q75.png)</span><br><span class="line"></span><br><span class="line"><span class="comment">## 内存分配</span></span><br><span class="line"></span><br><span class="line">前文提到，GPU计算时直接从显存中读取数据，因此每当计算时要将数据从主存拷贝到显存上，用CUDA的术语来说就是要把数据从主机端拷贝到设备端。CUDA强大之处在于它能自动将数据从主机和设备间相互拷贝，不需要程序员在代码中写明。这种方法对编程者来说非常方便，不必对原有的CPU代码做大量改动。</span><br><span class="line"></span><br><span class="line">我们以一个向量加法为例，编写一个向量加法的核函数如下：</span><br><span class="line"></span><br><span class="line">```py</span><br><span class="line">py@cuda.jit</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gpu_add</span>(<span class="params">a, b, result, n</span>):</span><br><span class="line">    <span class="comment"># a, b为输入向量，result为输出向量</span></span><br><span class="line">    <span class="comment"># 所有向量都是n维</span></span><br><span class="line">    <span class="comment"># 得到当前thread的索引</span></span><br><span class="line">    idx = cuda.threadIdx.x + cuda.blockDim.x * cuda.blockIdx.x</span><br><span class="line">    <span class="keyword">if</span> idx &lt; n:</span><br><span class="line">        result[idx] = a[idx] + b[idx]</span><br></pre></td></tr></table></figure>
<p>初始化两个2千万维的向量，作为参数传递给核函数：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">20000000</span></span><br><span class="line">x = np.arange(n).astype(np.int32)</span><br><span class="line">y = <span class="number">2</span> * x</span><br><span class="line">gpu_result = np.zeros(n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># CUDA执行配置</span></span><br><span class="line">threads_per_block = <span class="number">1024</span></span><br><span class="line">blocks_per_grid = math.ceil(n / threads_per_block)</span><br><span class="line"></span><br><span class="line">gpu_add[blocks_per_grid, threads_per_block](x, y, gpu_result, n)</span><br></pre></td></tr></table></figure>
<p>把上述代码整合起来，与CPU代码做对比，并验证结果正确性：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> numba <span class="keyword">import</span> cuda</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="meta">@cuda.jit</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gpu_add</span>(<span class="params">a, b, result, n</span>):</span><br><span class="line">    idx = cuda.threadIdx.x + cuda.blockDim.x * cuda.blockIdx.x</span><br><span class="line">    <span class="keyword">if</span> idx &lt; n:</span><br><span class="line">        result[idx] = a[idx] + b[idx]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    n = <span class="number">20000000</span></span><br><span class="line">    x = np.arange(n).astype(np.int32)</span><br><span class="line">    y = <span class="number">2</span> * x</span><br><span class="line"></span><br><span class="line">    gpu_result = np.zeros(n)</span><br><span class="line">    cpu_result = np.zeros(n)</span><br><span class="line"></span><br><span class="line">    threads_per_block = <span class="number">1024</span></span><br><span class="line">    blocks_per_grid = math.ceil(n / threads_per_block)</span><br><span class="line">    start = time()</span><br><span class="line">    gpu_add[blocks_per_grid, threads_per_block](x, y, gpu_result, n)</span><br><span class="line">    cuda.synchronize()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;gpu vector add time &quot;</span> + <span class="built_in">str</span>(time() - start))</span><br><span class="line">    start = time()</span><br><span class="line">    cpu_result = np.add(x, y)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;cpu vector add time &quot;</span> + <span class="built_in">str</span>(time() - start))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (np.array_equal(cpu_result, gpu_result)):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;result correct&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>运行结果，GPU代码竟然比CPU代码慢10+倍！</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gpu vector add <span class="keyword">time</span> 13.589356184005737</span><br><span class="line">cpu vector add <span class="keyword">time</span> 1.2823548316955566</span><br><span class="line">result correct</span><br></pre></td></tr></table></figure>
<p>说好的GPU比CPU快几十倍上百倍呢？这里GPU比CPU慢很多原因主要在于：</p>
<ol type="1">
<li>向量加法的这个计算比较简单，CPU的numpy已经优化到了极致，无法突出GPU的优势，我们要解决实际问题往往比这个复杂得多，当解决复杂问题时，优化后的GPU代码将远快于CPU代码。</li>
<li>这份代码使用CUDA默认的统一内存管理机制，没有对数据的拷贝做优化。CUDA的统一内存系统是当GPU运行到某块数据发现不在设备端时，再去主机端中将数据拷贝过来，当执行完核函数后，又将所有的内存拷贝回主存。在上面的代码中，输入的两个向量是只读的，没必要再拷贝回主存。</li>
<li>这份代码没有做流水线优化。CUDA并非同时计算2千万个数据，一般分批流水线工作：一边对2000万中的某批数据进行计算，一边将下一批数据从主存拷贝过来。计算占用的是CUDA核心，数据拷贝占用的是总线，所需资源不同，互相不存在竞争关系。这种机制被称为流水线。这部分内容将在下篇文章中讨论。</li>
</ol>
<p>原因2中本该程序员动脑思考的问题交给了CUDA解决，增加了时间开销，所以CUDA非常方便的统一内存模型缺点是计算速度慢。针对原因2，我们可以继续优化这个程序，告知GPU哪些数据需要拷贝到设备，哪些需要拷贝回主机。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> numba <span class="keyword">import</span> cuda</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="meta">@cuda.jit</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gpu_add</span>(<span class="params">a, b, result, n</span>):</span><br><span class="line">    idx = cuda.threadIdx.x + cuda.blockDim.x * cuda.blockIdx.x</span><br><span class="line">    <span class="keyword">if</span> idx &lt; n :</span><br><span class="line">        result[idx] = a[idx] + b[idx]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    n = <span class="number">20000000</span></span><br><span class="line">    x = np.arange(n).astype(np.int32)</span><br><span class="line">    y = <span class="number">2</span> * x</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 拷贝数据到设备端</span></span><br><span class="line">    x_device = cuda.to_device(x)</span><br><span class="line">    y_device = cuda.to_device(y)</span><br><span class="line">    <span class="comment"># 在显卡设备上初始化一块用于存放GPU计算结果的空间</span></span><br><span class="line">    gpu_result = cuda.device_array(n)</span><br><span class="line">    cpu_result = np.empty(n)</span><br><span class="line"></span><br><span class="line">    threads_per_block = <span class="number">1024</span></span><br><span class="line">    blocks_per_grid = math.ceil(n / threads_per_block)</span><br><span class="line">    start = time()</span><br><span class="line">    gpu_add[blocks_per_grid, threads_per_block](x_device, y_device, gpu_result, n)</span><br><span class="line">    cuda.synchronize()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;gpu vector add time &quot;</span> + <span class="built_in">str</span>(time() - start))</span><br><span class="line">    start = time()</span><br><span class="line">    cpu_result = np.add(x, y)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;cpu vector add time &quot;</span> + <span class="built_in">str</span>(time() - start))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (np.array_equal(cpu_result, gpu_result.copy_to_host())):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;result correct!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>这段代码的运行结果为：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gpu vector add <span class="keyword">time</span> 0.19940638542175293</span><br><span class="line">cpu vector add <span class="keyword">time</span> 1.132070541381836</span><br><span class="line">result correct!</span><br></pre></td></tr></table></figure>
<p>至此，可以看到GPU速度终于比CPU快了很多。</p>
<p>Numba对Numpy的比较友好，编程中一定要使用Numpy的数据类型。用到的比较多的内存分配函数有：</p>
<ul>
<li><code>cuda.device_array()</code>：
在设备上分配一个空向量，类似于<code>numpy.empty()</code></li>
<li><code>cuda.to_device()</code>：将主机的数据拷贝到设备</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ary = np.arange(<span class="number">10</span>)</span><br><span class="line">device_ary = cuda.to_device(ary)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>cuda.copy_to_host()</code>：将设备的数据拷贝回主机</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">host_ary = device_ary.copy_to_host()</span><br></pre></td></tr></table></figure>
<h2 id="总结">总结</h2>
<p>Python
Numba库可以调用CUDA进行GPU编程，CPU端被称为主机，GPU端被称为设备，运行在GPU上的函数被称为核函数，调用核函数时需要有执行配置，以告知CUDA以多大的并行粒度来计算。使用GPU编程时要合理地将数据在主机和设备间互相拷贝。</p>
<figure>
<img
src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/11/20/16e86a62ef44fe14~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.png"
alt="GPU程序执行流程" />
<figcaption aria-hidden="true">GPU程序执行流程</figcaption>
</figure>
<p>CUDA编程的基本流程为：</p>
<ol type="1">
<li>初始化，并将必要的数据拷贝到GPU设备的显存上。</li>
<li>使用某个执行配置，以一定的并行粒度调用CUDA核函数。</li>
<li>CPU和GPU异步计算。</li>
<li>将GPU计算结果拷贝回主机。</li>
</ol>
<h2 id="参考声明">参考声明</h2>
<ul>
<li><a
target="_blank" rel="noopener" href="https://juejin.cn/post/6844904000970571783">中文领域最详细的Python版CUDA入门教程</a></li>
<li><a
target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42596142/article/details/103157468">中文领域最详细的Python版CUDA入门教程</a></li>
<li><a
target="_blank" rel="noopener" href="https://www.nvidia.cn/docs/IO/51635/NVIDIA_CUDA_Programming_Guide_1.1_chs.pdf">NVIDIA
CUDA 编程指南(全译文)</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="上一页" aria-label="上一页" href="/page/20/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><span class="page-number current">21</span><a class="page-number" href="/page/22/">22</a><span class="space">&hellip;</span><a class="page-number" href="/page/55/">55</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="/page/22/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; Sat Sep 03 2022 08:00:00 GMT+0800 (中国标准时间) – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa-solid fa-star"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">fengzhenhua</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/fungzhenhua" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://s4.zstatic.net/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://s4.zstatic.net/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
  <script src="https://s4.zstatic.net/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.umd.js" integrity="sha256-a+H7FYzJv6oU2hfsfDGM2Ohw/cR9v+hPfxHCLdmCrE8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script src="/js/pjax.js"></script>

  <script src="https://s4.zstatic.net/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://s4.zstatic.net/ajax/libs/pdfobject/2.3.0/pdfobject.min.js","integrity":"sha256-JJZNsid68vnh3/zyj0lY9BN5ynxVX/12XgOa1TlaYN0="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js"></script>

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://s4.zstatic.net/ajax/libs/mermaid/11.4.0/mermaid.min.js","integrity":"sha256-G8ouPAnw4zzMbnAenHnVz6h9XpKbNdOkrqTh7AadyHs="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>


  <script src="/js/third-party/fancybox.js"></script>



  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"ams","js":{"url":"https://s4.zstatic.net/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
